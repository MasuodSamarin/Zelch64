!--------------------------------------------------
!- Saturday, May 20, 2017 12:05:25 AM
!- Import of : 
!- c:\src\zelch64\e1.prg
!- Commodore 64
!--------------------------------------------------
10 IFPEEK(726)=1THENWH=WH+1:POKE726,0:GOTO460
15 IFPEEK(720)=1THENCLOSEMD:POKE720,0:GOTO1000
20 GOTO1000
30 REM
50 SYS49152
60 IFPEEK(830)=1THEN300
70 RETURN
80 IFOU$=""THENRETURN
100 POKE254,ASC(OU$):SYS49155
110 RETURN
120 I$=""
150 SYS 49158
160 IFPEEK(830)=1THEN300
170 RETURN
180 REM
190 IFTX$=""THENRETURN
210 SYS 49161,TX$
220 RETURN
230 OU$="{clear}":GOSUB80:D5=0
260 CLOSE1:CLOSE8:OPEN1,MD,15:OPEN8,MD,8,FI$+",s,r"
270 SYS49164
280 IFPEEK(253)=1THEND5=1
290 CLOSE1:CLOSE8:RETURN
300 RL=2520:TX$="Standby...":GOSUB180
310 LOAD"{pound}@1",8,1
320 SYS49167:TT$=I$:RETURN
460 TX$="Mail...":GOSUB190
470 OPEN8,MD,8,"{pound}mail"+STR$(NA)+",s,r":GET#8,A$
480 IFST<>0ANDWH=0THENTX$="NO mail.. (SORRY)":GOSUB190:CLOSE8:GOTO680
490 CLOSE8:OPEN8,MD,8,"{pound}mail"+STR$(NA)+",s,r"
500 IFWH=0THEN510
501 I=1
502 SYS49152+18
503 IFST<>0THEN510
504 I=I+1:IFI<WHTHEN502
510 IFST<>0THENTX$="NO MORE mail..":GOSUB190:CLOSE8:GOTO660
520 GET#8,OU$:IFOU$="#"THEN550
530 IFST<>0THEN510
540 GOTO520
550 GET#8,O1$:GET#8,O2$:GET#8,O3$
560 I7=VAL(O1$+O2$+O3$)
570 CLOSE8:OPEN8,MD,8,"{pound}mail"+STR$(NA)+",s,r"
580 IFWH>0THENFORI=1TOWH:SYS49152+18:NEXT
590 SYS49164
600 CLOSE8:TX$=CHR$(14)+"1)Reply 2)Next 3)Reread":GOSUB190
610 GOSUB30
620 IFIN$="3"THEN570
630 IFIN$="2"THENWH=WH+1:GOTO470
640 IFIN$<>"1"THEN610
650 POKE726,1:GOSUB710:GOTO600
660 CLOSE1:CLOSE8:OPEN1,MD,15,"s0:{pound}mail"+STR$(NA)
670 TX$="Mail Deleted":GOSUB190:GOTO680
680 CLOSE1:OPEN1,MD,15:INPUT#1,E1,E1$,E2,E3:CLOSE1:GOTO1000
690 IFPEEK(726)=1THENPOKE726,0:GOTO570
700 TX$="User ID#:":GOSUB190:GOSUB120:IFI$=""THEN1000
701 IFLEN(I$)>4THEN1000
705 I7=VAL(I$):IFI7<1THEN1000
710 I2=I7/256:I3=I2*256:I4=I7-I3:CLOSE1:GOSUB860
720 PRINT#1,"p"CHR$(98)CHR$(I4)CHR$(I2)CHR$(35):GET#2,A$:INPUT#1,E1
730 I=1:IFA$=""ORE1<>0THENTX$="Not Found":GOSUB190:GOTO690
740 CLOSE1:CLOSE2:FI$="{pound}mail"+STR$(I7):GOSUB2000:GOTO820
820 CLOSE8
830 QQ$="FROM>"+NA$+" ID#"+STR$(NA)
840 GOSUB320:QD$="ON>"+STR$(MN)+"/"+STR$(DA)+" AT>"+TT$:V1=MD
850 POKE720,1:FF$="{pound}e1":GOTO980
860 CLOSE1:CLOSE2:OPEN1,8,15:OPEN2,8,2,"{pound}userlog":RETURN
980 TX$="Standby...":GOSUB190:
990 POKE721,ASC("e"):LOAD"{pound}m1",8,1
1000 TX$="Email:":GOSUB190
1010 GOSUB30:IFIN$=""THEN1010
1030 IFIN$="?"THENFI$="{pound}emailmenu":TX$="?"+CHR$(13):GOSUB190:GOSUB230:GOTO1000
1040 IFIN$="r"THENWH=0:GOTO460
1050 IFIN$="s"THENTX$="s"+CHR$(13):GOSUB190:GOTO700
1060 IFIN$="q"THEN1080
1065 IFIN$="u"THEN3190
1070 GOTO1010
1080 TX$="Standby...":GOSUB190:
1090 LOAD"{pound}b1",8,1
2000 FORI=1TOLEN(FI$):POKE681+I,ASC(MID$(FI$,I,1)):NEXTI:POKE681+I,0:RETURN
3190 TX$="{cyan}Start at:":GOSUB190:GOSUB120:IFLEN(I$)>4ORI$=""THEN1000
3195 S1=VAL(I$):IFS1<1THEN1000
3200 OPEN1,8,15:OPEN2,8,2,"{pound}userlog"
3210 GOSUB30:IFIN$=" "THENCLOSE1:CLOSE2:GOTO1000
3230 I1=INT(S1/256):I3=I1*256:I2=S1-I3
3240 PRINT#1,"p"CHR$(98)CHR$(I2)CHR$(I1)CHR$(5):GET#2,A$:INPUT#1,E1
3250 IFA$=""ORE1<>0THENCLOSE1:CLOSE2:GOTO1000
3255 PRINT#1,"p"CHR$(98)CHR$(I2)CHR$(I1)CHR$(5):SYS49185
3257 IFI$="EMPTY"THEN3270
3260 N$=I$:TX$=STR$(S1)+":"+N$:GOSUB190
3270 S1=S1+1:GOTO3210
