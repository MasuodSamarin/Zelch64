!--------------------------------------------------
!- Saturday, May 20, 2017 4:11:55 PM
!- Import of : 
!- c:\src\zelch64\prg.monster.prg
!- Commodore 64
!--------------------------------------------------
8000 FORI=0TO9:POKE43+I,PEEK(721+I):NEXT
8010 PRINT"calls update":LO=1:HI=4096:PRINT"Counting users...":C=HI/2
8550 OPEN1,8,15,"i0":OPEN2,8,3,"0:{pound}userlog":FORR=0TO11
8560 C2=INT(C/256):C3=C2*256:C1=C-C3:I=5:GOSUB6:INPUT#1,E:GET#2,A$
8580 IFA$=""ORE>0THENHI=C:D=HI-LO:D=D/2:C=C-D:GOTO8590
8585 LO=C:D=HI-LO:D=D/2:C=C+D
8590 PRINT"{home}{down*6}";STR$(INT(C));"  ":NEXTR:SYSZ,2:SYSZ,1
8620 PRINTCHR$(13)+"Saving Calls..."
8630 OPEN1,8,15,"s0:{pound}calls":OPEN2,8,3,"0:{pound}calls,l,"+CHR$(6)
8640 FORX=1TOC+3:C2=INT(X/256):C3=C2*256:C1=X-C3
8650 I=1:GOSUB6:PRINT#2,"0":NEXTX:SYSZ,1:SYSZ,2:GOSUB8700:PRINT
8660 PRINT"Validating Disk(s)...":SYSZ,1:OPEN1,8,15,"v0":SYSZ,1
8661 IFUL<>8THENOPEN1,UL,15,"v0":SYSZ,1
8662 IFMD<>8ANDMD<>ULTHENOPEN1,MD,15,"v0":SYSZ,1
8670 IFDD=0THENDA=DA+1:IFDA>DA(MN)THENMN=MN+1:DA=1:IFMN=13THENMN=1
8675 IFDD=0THENPOKE733,0
8680 DD=0:POKE703,MN:POKE704,DA:POKE709,O
8690 GOTO390
8700 I9=0:I5=0:PRINT"{down}Checking for OLD users...";
8710 IFMN>1THENFORI=1TOMN-1:I9=I9+DA(I):NEXTI
8720 I9=I9+DA:OPEN1,8,15,"i0":OPEN2,8,3,"0:{pound}userlog":FORX=1TOC:C2=INT(X/256)
8730 I1=0:C3=C2*256:C1=X-C3:I=5:GOSUB7:IFI$=""ORI$="EMPTY"THEN8780
8740 NN$=I$:I=60:GOSUB7:I7=VAL(LEFT$(I$,2)):I8=VAL(RIGHT$(I$,3)):LC$=I$
8741 IFI7=0ORI8=0THEN8780
8745 IFLEN(LC$)<3THEN8780
8750 IFI7>1THENFORI=1TOI7-1:I1=I1+DA(I):NEXTI
8760 I1=I1+I8
8762 I4=I9-I1
8765 IFI4>45THENI3=365-I9:I4=I3+I1:
8766 IFI4<0THENI4=I4+365
8770 IFI4>45ORI1>I9THENTT$(I5)=NN$:Z1(I5)=X:Z2(I5)=I4:I5=I5+1
8780 PRINT".";:NEXTX:SYSZ,1:SYSZ,2:OPEN1,8,15,"s0:{pound}delete!":SYSZ,1
8781 IFI5=0THENRETURN
8785 OPEN8,8,8,"{pound}delete!,s,w":FORI=0TOI5
8786 PRINT#8,TT$(I)+" ID#"+STR$(Z1(I)):PRINT#8,STR$(Z2(I))+"days missed"
8790 NEXTI:SYSZ,8:RETURN
