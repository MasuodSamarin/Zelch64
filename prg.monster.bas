!--------------------------------------------------
!- Friday, May 12, 2017 11:13:44 PM
!- Import of : 
!- c:\src\zelch64\bak\prg.monster.prg
!- Commodore 64
!--------------------------------------------------
8000 SYS51983:CLOSE2:PRINT"initializing!":PRINT#8,"s0:{pound}delete":FORI=8TO7+D0
8010 PRINT#I,"s0:msg":PRINT#I,"i0":NEXTI:PRINT"{down*2}user update part I";
8020 OPEN2,8,2,"{pound}log1":C=1:U=1:V=0
8030 A$="":I=0:GOSUB3:GET#2,A$:IFA$<>"{pound}"THENC=C-1:GOTO8050
8040 C=C+1:V=INT(C/256):U=C-(V*256):PRINT".";:GOTO8030
8050 CLOSE2:PRINT:PRINT"{down*2}user update part II...";:GOSUB75:AA=A:AA=INT(AA/10000)
8060 OPEN2,8,2,"{pound}log2":CT=0
8070 FORX=1TOC:V=INT(X/256):U=X-(V*256)
8080 I=0:GOSUB3:INPUT#2,A$,B$:I1=VAL(B$)
8090 I1=INT(I1/10000):B=AA-I1:IFB>999ORCT>50THEN8110
8100 IFB>45THENZ1(CT)=X:Z2(CT)=B:CT=CT+1
8110 PRINT".";:A$=""
8140 NEXTX:CLOSE2:IFCT=0THEN8300
8150 OPEN2,8,2,"{pound}delete,s,w":FORI=0TOCT:PRINT#2," ID#"+STR$(Z1(I))
8160 PRINT#2,STR$(Z2(I))+" days missed":NEXTI:CLOSE2:GOTO8300
8200 A=FRE(0):PRINT:PRINT"validating disk(s)...":FORI=8TO7+D0:PRINT#I,"v0":NEXT
8230 IFPEEK(713)=15THENDA=DA+1:IFDA>DA(MN)THENMN=MN+1:DA=1:IFMN=13THENMN=1
8240 POKE703,MN:POKE704,DA:POKE712,YR:POKE733,0:POKE702,16
8250 FORI=8TO7+D0:CLOSEI:CLOSE15:CLOSE2:CLOSE3:RUN
8300 FORCS=0TON(0):PRINT:PRINT"examining sig "+CHR$(65+CS)+"...";:D=DV(0,CS)
8305 OPEN2,8,2,"{pound}Sig "+CHR$(97+CS):U=1:V=0:I=0:GOSUB3:INPUT#2,NM,MP
8310 FORU=2TONM+1:W=U-1:GOSUB3:INPUT#2,Z1(W),Z2(W):NEXTU:CLOSE2
8320 FORM=1TONM:IFZ1(M)<M1THEN8400
8330 PRINT:PRINT"rewriting message #"+STR$(M)+"...":A$="{pound}msg "+CHR$(65+CS)+STR$(M)
8340 PRINT#D,"r0:msg="+A$:OPEN2,D,2,"0:msg,s,r":OPEN3,D,3,"0:"+A$+",s,w"
8350 SYS38230:IFI$<>CHR$(1)THENPRINT#3,I$:GOTO8350
8360 PRINT#3,I$:FORX=1TOZ1(M)-M2:SYS38218:Z1(M)=Z1(M)-1:NEXTX:SYS38230
8370 SYS38230:IFPEEK(253)=0THENPRINT#3,I$:GOTO8370
8380 PRINT#3,I$:CLOSE3:CLOSE2:X=Z1(M):Y=Z2(M):PRINT#D,"s0:msg":GOSUB2620
8400 NEXTM:PRINT:NEXTCS:PRINT:CS=0:GOTO8200
