!--------------------------------------------------
!- Saturday, May 20, 2017 2:17:56 PM
!- Import of : 
!- c:\src\zelch64\prg.user.prg
!- Commodore 64
!--------------------------------------------------
8000 FORI=0TO9:POKE43+I,PEEK(721+I):NEXT:GOTO3150
8005 TX$="User #{ct c}":GOSUB210:GOSUB111:IFI=0THEN3150
8010 C2=INT(I/256):C3=C2*256:C1=I-C3:OPEN1,8,15,"i0":OPEN2,8,2,"0:{pound}userlog"
8020 PRINT#1,"p"CHR$(98)CHR$(C1)CHR$(C2)CHR$(5):GET#2,A$:INPUT#1,E1
8030 IFA$=""ORE1>0THENCLOSE1:CLOSE2:TX$="no record":GOSUB210:GOTO3150
8500 GOSUB8550
8510 TX$="Handle:"+TT$(0)+":{ct c}":GOSUB210:GOSUB190:IFLEN(I$)>17THEN8510
8520 IFI$<>""THENTT$(0)=I$
8530 GOTO8590
8540 PRINT#1,"p"CHR$(98)CHR$(C1)CHR$(C2)CHR$(I):SYS38233:RETURN
8550 I=5:GOSUB8540:TT$(0)=I$:I=25:GOSUB8540:TT$(1)=I$:I=35:GOSUB8540
8560 TT$(2)=I$:I=40:GOSUB8540:TT$(3)=I$:I=60:GOSUB8540:TT$(4)=I$
8570 GOSUB8540:TT$(5)=I$:I=90:GOSUB8540:TT$(6)=I$
8580 CT=7:FORI=100TO145STEP5:GOSUB8540:TT$(CT)=I$:CT=CT+1:NEXTI:RETURN
8590 TX$="Fone #:"+TT$(1)+":{ct c}":GOSUB210:GOSUB190:IFLEN(I$)>8THEN8590
8600 IFI$<>""THENTT$(1)=I$
8610 TX$="Access:"+TT$(2)+":{ct c}":GOSUB210:GOSUB190:IFLEN(I$)>1THEN8610
8620 IFI$<>""THENTT$(2)=I$
8630 TX$="Name:"+TT$(3)+":{ct c}":GOSUB210:GOSUB190:IFLEN(I$)>17THEN8630
8640 IFI$<>""THENTT$(3)=I$
8643 TX$="Pass:"+TT$(6)+":{ct c}":GOSUB210:GOSUB190:IFLEN(I$)>7THEN8643
8646 IFI$<>""THENTT$(6)=I$
8647 FORI=7TO12:TX$="Var"+STR$(I-7)+":"+TT$(I)+":{ct c}":GOSUB210:GOSUB190
8648 IFLEN(I$)>4THEN8647
8649 IFI$<>""THENTT$(I)=I$
8650 NEXTI
8651 TX$="S)ave E)dit or A)bort:{ct c}":GOSUB210:GOSUB190:IFI$="e"THEN8510
8660 IFI$="a"THENCLOSE1:CLOSE2:GOTO3150
8670 IFI$<>"s"THEN8651
8680 I=5:GOSUB8730:PRINT#2,TT$(0):I=25:GOSUB8730:PRINT#2,TT$(1):I=35:GOSUB8730
8690 PRINT#2,TT$(2):I=40:GOSUB8730:PRINT#2,TT$(3):I=60:GOSUB8730:PRINT#2,TT$(4)
8700 I=80:GOSUB8730:PRINT#2,TT$(5):I=90:GOSUB8730:PRINT#2,TT$(6)
8710 CT=7:FORI=100TO145STEP5:GOSUB8730:PRINT#2,TT$(CT):CT=CT+1:NEXTI
8720 CLOSE1:CLOSE2:GOTO3150
8730 PRINT#1,"p"CHR$(98)CHR$(C1)CHR$(C2)CHR$(I):RETURN
