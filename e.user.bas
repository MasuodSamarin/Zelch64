!--------------------------------------------------
!- Saturday, May 20, 2017 12:05:18 AM
!- Import of : 
!- c:\src\zelch64\e.user.prg
!- Commodore 64
!--------------------------------------------------
1000 PRINT"{clear}Put your data disk in drive 8"
1010 PRINT"and press return"
1020 GETA$:IFA$<>CHR$(13)THEN1020
5000 PRINT"{clear}"+CHR$(14)+"{yellow}":POKE53280,0:POKE53281,0
7000 PRINT"{clear}1) Create new user log"
7005 PRINT"2) Edit User Log"
7007 PRINT"3) Display  Users"
7010 PRINT"4) Exit"
7020 GETA$:IFA$="1"THEN7450
7025 IFA$="3"THEN7080
7030 IFA$="4"THEN8000
7035 IFA$<>"2"THEN7020
7040 GOTO7200
7080 INPUT"start at record";S1
7100 PRINT"space aborts..."
7105 OPEN1,8,15:OPEN2,8,2,"{pound}userlog"
7110 I1=INT(S1/256):I3=I1*256:I2=S1-I3:
7120 PRINT#1,"p"CHR$(98)CHR$(I2)CHR$(I1)CHR$(5):GET#2,A$:INPUT#1,E1
7121 IFE1<>0ORA$=""THEN7190
7125 PRINT#1,"p"CHR$(98)CHR$(I2)CHR$(I1)CHR$(5)
7130 INPUT#2,NA$:PRINT"#";S1;" ";NA$:GETA$:IFA$=" "THEN7190
7140 S1=S1+1:GOTO7110
7150 GOTO7110
7190 CLOSE2:CLOSE1:PRINT"hit any key"
7195 POKE198,0:WAIT197,64,64:GOTO7000
7200 INPUT"enter the record to edit";S1:I1=INT(S1/256):I3=I1*256:I2=S1-I3
7210 OPEN1,8,15:OPEN2,8,2,"{pound}userlog"
7211 PRINT#1,"p"CHR$(98)CHR$(I2)CHR$(I1)CHR$(5):GET#2,A$
7212 IFST=0ANDA$<>""THEN7230
7213 PRINT"no record":FORI=0TO2000:NEXT:GOTO 7330
7220 PRINT#1,"p"CHR$(98)CHR$(I2)CHR$(I1)CHR$(I):IFI<100THENINPUT#2,A$
7225 RETURN
7230 I=5:GOSUB7220:NA$=A$:I=25:GOSUB7220:PH$=A$:I=35:GOSUB7220:AC$=A$:
7240 I=40:GOSUB7220:RN$=A$:I=60:GOSUB7220:LA$=A$
7250 I=80:GOSUB7220:TM$=A$:I=90:GOSUB7220:PA$=A$:I=100:GOSUB7220
7260 O=0:FORI=100TO145STEP5:GOSUB7220:INPUT#2,P$(O):O=O+1:NEXT
7270 PRINT"name:";NA$:PRINT"Phone:";PH$:PRINT"Access lvl:";AC$:
7280 PRINT"Real Name:";RN$:PRINT"Last Call Date:";LA$
7290 PRINT"off at:";TM$:PRINT"password:";PA$:FORI=0TO9
7300 PRINT"variable #"I" = ";P$(I):NEXT:PRINT"Edit this record?"
7310 GETA$:IFA$="n"THENCLOSE2:CLOSE1:GOTO7000
7320 IFA$<>"y"THEN7310
7330 INPUT"name:";NA$:INPUT"Phone:";PH$:INPUT"Access lvl:";AC$:
7340 INPUT"Real Name:";RN$:INPUT"Last Call Date:";LA$:INPUT"Calls today:";CA$
7350 INPUT"off at:";TM$:INPUT"password:";PA$:FORI=0TO9
7360 PRINT"variable #"I" = ";:INPUTP$(I):NEXT:PRINT"Save this record?"
7370 GETA$:IFA$="n"THEN7270
7380 IFA$<>"y"THEN7370
7390 GOTO7760
7450 PRINT"Delete old userlog and make new one"
7460 PRINT"ok? (y/n)"
7470 GETA$:IFA$="n"THEN7000
7480 IFA$<>"y"THEN7470
7500 PRINT"enter your name (20 chars)":INPUTNA$
7510 PRINT"enter the phone #(10 chars)":INPUTPH$
7520 AC$="9":INPUT"your real name(20 chars)";RN$
7530 LA$="1/ 1":TM$="12]59":INPUT"password (7 chars)";PA$
7535 FORI=0TO9:P$(I)="0":NEXT
7540 PRINT"take this questionare again (Y/N)"
7550 GETA$:IFA$="y"THEN7500
7560 IFA$<>"n"THEN7550
7749 OPEN1,8,15,"s0:{pound}userlog":I2=1:I1=0
7750 OPEN2,8,2,"{pound}userlog,l,"+CHR$(150)
7760 PRINT#1,"p"CHR$(2+96)CHR$(I2)CHR$(I1)CHR$(1)
7770 PRINT#2,"0000";NA$
7775 PRINT#1,"p"CHR$(2+96)CHR$(I2)CHR$(I1)CHR$(1)
7780 PRINT#1,"p"CHR$(2+96)CHR$(I2)CHR$(I1)CHR$(25)
7790 PRINT#2,PH$
7795 PRINT#1,"p"CHR$(2+96)CHR$(I2)CHR$(I1)CHR$(25)
7800 PRINT#1,"p"CHR$(2+96)CHR$(I2)CHR$(I1)CHR$(35)
7810 PRINT#2,AC$
7815 PRINT#1,"p"CHR$(2+96)CHR$(I2)CHR$(I1)CHR$(35)
7820 PRINT#1,"p"CHR$(2+96)CHR$(I2)CHR$(I1)CHR$(40)
7830 PRINT#2,RN$
7835 PRINT#1,"p"CHR$(2+96)CHR$(I2)CHR$(I1)CHR$(40)
7840 PRINT#1,"p"CHR$(2+96)CHR$(I2)CHR$(I1)CHR$(60)
7850 PRINT#2,LA$
7855 PRINT#1,"p"CHR$(2+96)CHR$(I2)CHR$(I1)CHR$(60)
7880 PRINT#1,"p"CHR$(2+96)CHR$(I2)CHR$(I1)CHR$(80)
7885 PRINT#2,TM$
7887 PRINT#1,"p"CHR$(2+96)CHR$(I2)CHR$(I1)CHR$(80)
7890 PRINT#1,"p"CHR$(2+96)CHR$(I2)CHR$(I1)CHR$(90)
7895 PRINT#2,PA$
7897 PRINT#1,"p"CHR$(2+96)CHR$(I2)CHR$(I1)CHR$(90):GOTO7910
7900 PRINT#1,"p"CHR$(98)CHR$(I2)CHR$(I1)CHR$(I):PRINT#2,P$(O)
7902 PRINT#1,"p"CHR$(98)CHR$(I2)CHR$(I1)CHR$(I):RETURN
7910 O=0:FORI=100TO145STEP5:GOSUB7900:O=O+1:NEXT
7920 CLOSE2:CLOSE1
7950 PRINT"done. hit any key"
7960 POKE198,0:WAIT197,64,64:GOTO7000
8000 PRINT"Insert your SYSTEM disk in drive 8"
8001 PRINT"and press return"
8002 GETA$:IFA$<>CHR$(13)THEN8002
8005 PRINT"hold on..."
8010 LOAD"e.menu",8
