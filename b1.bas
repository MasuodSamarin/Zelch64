!--------------------------------------------------
!- Friday, May 19, 2017 9:53:04 PM
!- Import of : 
!- c:\src\zelch64\b1.prg
!- Commodore 64
!--------------------------------------------------
10 IFPEEK(766)<>1THEN1740
15 POKE766,0
20 IFRL=2070THEN1740
60 IFRL=2680THEN2280
230 SYS 49152
260 IFPEEK(830)=1THEN2060
270 RETURN
280 IFOU$=""THENRETURN
300 POKE254,ASC(OU$):SYS49155
310 RETURN
470 SYS 49158
510 IFPEEK(830)=1THEN2060
520 RETURN
530 IFTX$=""THENRETURN
535 REM
560 SYS 49161,TX$
570 RETURN
1740 CLOSE1:OU$=CHR$(14):GOSUB280:PRINTNA$+" is on-line":GOSUB3700
1760 FORI=763TO766:POKEI,0:NEXTI
1770 TX$=CHR$(13)+"{green}TIME={light green}"+TT$+"{white}:?:{blue}C{light blue}O{cyan}M{white}M{yellow}A{pink}N{red}D{white}:":GOSUB530
1780 GOSUB230:IFIN$=""THEN1780
1790 TX$=IN$:GOSUB530
1830 IFIN$="?"THENFI$="{pound}mainmenu"+STR$(AC):GOSUB1990:GOTO1740
1840 IFIN$="f"THENGOTO2170
1870 IFIN$="o"THENGOTO2840
1880 IFIN$="i"THENFI$="{pound}info":GOSUB1990:GOTO1740
1890 IFIN$="c"THENGOSUB2560:GOTO1740
1920 IFPEEK(197)=5THENGOSUB2990:GOTO1740
1930 IFIN$="u"THENGOSUB3190:GOTO1740
1950 IFIN$="s"THENGOSUB3490:GOTO1740
1951 YY$="":FORI=0TOMO:IFIN$=M3$(I)ANDAC>=M2(I)THENYY$=M1$(I):V1=8
1952 NEXT:IFYY$<>""THEN3470
1960 GOTO1740
1970 POKE764,0:POKE766,1:TX$="Standby...":GOSUB530
1980 POKE721,ASC("b"):LOAD"{pound}m1",8,1
1990 OU$="{clear}":GOSUB280
2020 CLOSE1:CLOSE8:OPEN1,8,15:OPEN8,8,8,FI$+",s,r"
2030 SYS49164
2040 IFPEEK(253)=1THEND5=1
2050 CLOSE1:CLOSE8:RETURN
2060 RL=2520:TX$="Standby...":GOSUB530
2070 LOAD"{pound}@1",8,1
2170 TX$="Send feedback to the sysop?:":GOSUB530
2180 GOSUB230
2190 IFIN$="n"ANDPEEK(765)<>1THEN1740
2200 IFIN$="n"ANDPEEK(765)=1THEN2060
2210 IFIN$<>"y"THEN2180
2220 CLOSE8:CLOSE1:CLOSE2
2230 FI$="{pound}feedback":QQ$="BY>"+NA$+" ID#"+STR$(NA):GOSUB4000
2240 GOSUB3700:QD$="ON>"+STR$(MN)+"/"+STR$(DA)+"  AT>"+TT$:V1=8
2250 EW=0:RL=2680:GOTO1970
2280 CLOSE8:CLOSE1
2290 IFPEEK(765)=1THEN2060
2300 GOTO1740
2550 CLOSE8:CLOSE1:CLOSE2:OPEN1,8,15:OPEN2,8,2,"{pound}userlog":RETURN
2560 TX$="Page the SysOp?:":GOSUB530:
2570 GOSUB230:IFIN$=""THEN2570
2580 IFIN$="n"THENRETURN
2590 IFIN$<>"y"THEN2570
2600 TX$=CHR$(13)+"Making rude noises...":GOSUB530:POKE53280,1
2610 FORI=54272TO54295:POKEI,0:NEXT:POKE54296,15
2620 POKE54277,8:POKE54278,255:POKE54276,21:I2=255:
2630 FORI=1TO40:POKE54287,I2:OU$="+":GOSUB280
2640 FORI1=255TO0STEP-20:POKE54273,I1:I2=I2-.1
2650 NEXTI1
2660 NEXTI:POKE54278,15:RETURN
2840 TX$="{red}Exit..{white} are you SURE??:":GOSUB530
2850 GOSUB230:IFIN$=""THEN2850
2860 IFIN$="n"THENTX$="n":GOSUB530:GOTO1740
2870 IFIN$<>"y"THEN2850
2880 TX$=CHR$(1):GOSUB530:POKE765,1:GOTO2170
2990 PRINT"CURRENT{sh space}ACCESS{sh space}IS";AC
3000 INPUT"NEW{sh space}ACCESS";AC$:IFAC$=""THENRETURN
3010 AC=VAL(AC$):RETURN
3190 TX$="{light blue}Start at:":GOSUB530:GOSUB470::IFLEN(I$)>4ORI$=""THENRETURN
3195 S1=VAL(I$):IFS1<1THENRETURN
3200 CLOSE1:CLOSE2:CLOSE8:OPEN1,8,15:OPEN2,8,2,"{pound}userlog"
3210 GOSUB230:IFIN$=" "THENRETURN
3230 I1=INT(S1/256):I3=I1*256:I2=S1-I3
3240 PRINT#1,"p"CHR$(98)CHR$(I2)CHR$(I1)CHR$(5):GET#2,A$:INPUT#1,E1
3250 IFA$=""ORE1<>0THENCLOSE1:CLOSE2:RETURN
3255 PRINT#1,"p"CHR$(98)CHR$(I2)CHR$(I1)CHR$(5):SYS49185
3257 IFI$="EMPTY"THEN3270
3260 N$=I$:TX$=STR$(S1)+":"+N$:GOSUB530
3270 S1=S1+1:GOTO3210
3470 TX$="Standby...":GOSUB530:POKE766,1:RL=2070
3475 IFV1=0ORV1<8ORV1>11THENV1=8
3480 LOADYY$,V1,1
3490 TX$="":GOSUB530
3500 TX$="{blue}--------------------":GOSUB530
3510 TX$="{light blue}Status: ":GOSUB530
3520 TX$="{cyan}Handle:"+NA$:GOSUB530:TX$="{white}Real name:"+RN$:GOSUB530
3530 TX$="{yellow}Access:"+AC$:GOSUB530:GOSUB3700
3540 TX$="{pink}Calls today:"+CA$:GOSUB530:TX$="{red}Current time :"+TT$:GOSUB530
3550 GOSUB3770:TX$="{white}Logoff time :"+TT$:GOSUB530
3560 TX$="{blue}--------------------":GOSUB530
3570 RETURN
3580 REM
3700 H=PEEK(56331):M=PEEK(56330):S=PEEK(56329):T=PEEK(56328):CH=0
3710 IFH>128THENCH=128:TT$="pm":GOTO3720
3715 TT$="am"
3720 H1=(HAND16)/16:H2=(HAND15):M1=(MAND240)/16:M2=(MAND15)
3730 H1$=RIGHT$(STR$(H1),1)
3740 H2$=RIGHT$(STR$(H2),1):M1$=RIGHT$(STR$(M1),1):M2$=RIGHT$(STR$(M2),1)
3750 IFH1=0THENTT$=H2$+"]"+M1$+M2$+TT$:RETURN
3760 TT$=H1$+H2$+"]"+M1$+M2$+TT$:RETURN
3770 H=PEEK(896):M=PEEK(897):S=PEEK(898):T=PEEK(899):CH=0
3780 IFH>128THENCH=128:TT$="pm":GOTO3790
3785 TT$="am"
3790 H1=(HAND16)/16:H2=(HAND15):M1=(MAND240)/16:M2=(MAND15)
3800 H1$=RIGHT$(STR$(H1),1)
3810 H2$=RIGHT$(STR$(H2),1):M1$=RIGHT$(STR$(M1),1):M2$=RIGHT$(STR$(M2),1)
3820 IFH1=0THENTT$=H2$+"]"+M1$+M2$+TT$:RETURN
3830 TT$=H1$+H2$+"]"+M1$+M2$+TT$:RETURN
4000 FORI=1TOLEN(FI$):POKE681+I,ASC(MID$(FI$,I,1)):NEXTI:POKE681+I,0:RETURN
