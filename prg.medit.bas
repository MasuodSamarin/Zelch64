!--------------------------------------------------
!- Saturday, May 20, 2017 4:57:17 PM
!- Import of : 
!- c:\src\zelch64\prg.medit.prg
!- Commodore 64
!--------------------------------------------------
8000 FORI=0TO9:POKE43+I,PEEK(721+I):NEXT
8010 TX$="{clear}{down*2}{f1}SUBOP EDITING"+CR$+"{f1}D)ELETE MSG"+CR$+"{f1}R)ESPONSE EDIT":GOSUB5
8020 TX$="{f1}E)DIT SIG MSG"+CR$+"{f1}Q)UIT{sh space}TO{sh space}MAIN"+CR$+"{down*2}>{ct c}":GOSUB5:C$="dreq"
8030 GOSUB66:ONGGOTO8300,8100,8400,8070
8070 I$="{pound}prg.read":GOTO44
8100 V1=DV(0,CS):TX$="EDIT{sh space}MSG #{ct c}":GOSUB5:GOSUB30:IFI=0ORI>NMORZ1(I)=0THEN8010
8110 I1=I:I2=Z1(I):PRINT#V1,"s0:msg":PRINT#V1,"r0:msg={pound}msg "+CHR$(65+CS)+STR$(I1)
8120 CT=1:TX$="{f1}RESAVING MESSAGE...":GOSUB5:OPEN3,V1,8,"0:msg,s,r"
8130 OPEN4,V1,9,"0:{pound}msg "+CHR$(CS+65)+STR$(I1)+",s,w"
8140 SYS38230:IFI$<>CHR$(1)THENPRINT#4,I$:GOTO8140
8150 TX$="{f1}SAVE RESPONSE #"+STR$(CT)+"(Y/N)?{ct c}":GOSUB5:C$="yn":GOSUB66
8160 IFG=2THEN8230
8170 PRINT#4,CHR$(1)
8180 SYS38230:IFI$=CHR$(1)THEN8210
8190 IFPEEK(253)=1THENPRINT#4,I$:A=FRE(0):GOTO8250
8200 PRINT#4,I$:GOTO8180
8210 IFCT=I2THEN8250
8220 CT=CT+1:GOTO8150
8230 SYS38218:Z1(I1)=Z1(I1)-1:IFZ1(I1)=0ORCT=I2THEN8250
8240 GET#3,A$:GOTO8210
8250 CLOSE4:CLOSE3:PRINT#V1,"s0:msg":M=I1:X=Z1(M):Y=Z2(M):GOSUB2620:GOTO8010
8300 V1=DV(0,CS):TX$="{f1}DELETE MSG #{ct c}":GOSUB5:GOSUB30:IFI=0ORI>NMTHEN8010
8310 TX$="DELETING...":GOSUB5:PRINT#V1,"s0:{pound}msg "+CHR$(CS+65)+STR$(I)
8320 OPEN3,V1,V1,"0:{pound}msg "+CHR$(65+CS)+STR$(I)+",s,w":PRINT#3,"NO MESSAGE"
8330 PRINT#3,CHR$(2):FORX=1TO5:PRINT#3,"{black}":NEXT:PRINT#3,"DELETED MESSAGE"
8340 CLOSE3:M=I:X=0:Y=0:GOSUB2620:GOTO8010
8400 UP=0:TX$="SEARCHING...":GOSUB5:OPEN3,DV(0,CS),8,"{pound}sigmsg "+STR$(CS+65)
8410 FORI=0TO50:TT$(I)="{black}":NEXT:LN=0:V1=DV(0,CS)
8420 CLOSE3:INPUT#DV(0,CS),E:IFE=0THEN8440
8430 TX$="NEW{sh space}FILE! EDITOR:":GOSUB5:I$="{black}":LN=-1:GOTO8500
8440 TX$="LOADING...":GOSUB5:OPEN3,V1,V1,"{pound}sigmsg "+STR$(CS+65)
8450 SYS38230:IFPEEK(253)=1THENTT$(LN)=I$:GOTO8500
8460 IFI$=CHR$(142)+CHR$(147)THENUP=1:GOTO8450
8470 SYS38209,I$:TT$(LN)=I$:LN=LN+1:GOTO8450
8500 FF$="{pound}sigmsg "+STR$(CS+65):S3=1:QD$="":CLOSE3:SYS38209,I$
8510 LN=LN+1:S0=1:GOSUB5000:GOTO8010
