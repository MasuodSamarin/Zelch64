!--------------------------------------------------
!- Saturday, May 20, 2017 4:12:29 PM
!- Import of : 
!- c:\src\zelch64\prg.read.prg
!- Commodore 64
!--------------------------------------------------
8000 FORI=0TO9:POKE43+I,PEEK(721+I):NEXT:GOTO4055
8005 TX$="{f1}READ MSG #{ct c}":GOSUB210:GOSUB111:IFI=0ORI$=""THEN4260
8010 CM=I
8020 IFCM>NMTHENTX$="End of Messages":GOSUB210:CM=NM:WI=0:GOTO4260
8025 IFCM<1THENCM=0:WI=0:GOTO4260
8030 I1=Z1(CM):I2=Z2(CM)
8035 TX$="{f1}Message #"+RIGHT$(STR$(CM),LEN(STR$(CM))-1):GOSUB210
8037 GOSUB5:OPEN8,SD(CS),8,"0:{pound}msg"+STR$(CS)+STR$(CM):SYS38212
8040 SYSZ,8:IFPEEK(252)=1THENTX$=CHR$(13)+"hit return{ct c}":GOSUB210:GOSUB6370
8048 IFI1=0THEN8190
8049 TX$=CHR$(14)+"{f1}"+STR$(I1)+" Response(s) Counted.":GOSUB210
8050 NE=0:I9=0:TX$=CHR$(14)+"{f1}N)ew, {f1}S)kip, {f1}Q)uit, or {f1}RETURN:{ct c}":GOSUB210
8060 GOSUB100:IFIN$=""ORIN$=" "THEN8060
8070 TX$=IN$:GOSUB210:IFIN$="q"THEN8190
8080 IFIN$="s"THEN4690
8085 IFIN$="n"THENNE=1:IN$=CHR$(13)
8090 IFIN$<>CHR$(13)THEN8050
8100 GOSUB5:OPEN8,SD(CS),8,"0:{pound}msg"+STR$(CS)+STR$(CM):SYS38218
8110 IFI9=0THEN8130
8120 FORI=1TOI9:SYS38218:NEXTI
8125 IFI9>=I1THENSYSZ,8:GOTO8190
8130 SYS38230:SYS38230:IFVAL(I$)<=PPANDNE=1THENSYS38218:GOTO8180
8131 TX$="{clear}{white}Response #"+STR$(I9+1):GOSUB210:SYS38212
8132 IFPEEK(252)=1THENTX$=CHR$(13)+"hit return{ct c}":GOSUB210:GOSUB6370
8140 TX$=CHR$(14)+"{f1}RETURN continues or A)bort:{ct c}":GOSUB210
8150 GOSUB100:IFIN$<>CHR$(13)ANDIN$<>"a"THEN8150
8160 TX$=IN$:GOSUB210:IFIN$="a"THENSYSZ,8:GOTO4260
8170 IFIN$<>CHR$(13)THEN8150
8180 I9=I9+1:GOTO8125
8190 IFAC<VAL(MID$(CG$,G,1))THEN4260
8200 TX$=CHR$(14)+CHR$(13)+"{light green}{f1}{reverse on}Reply (Y/N/Q)?{reverse off}{white}{ct c}":GOSUB210
8210 GOSUB100:IFIN$="n"ORIN$=CHR$(13)THENTX$="n":GOSUB210:GOTO4260
8220 IFIN$="q"THENWI=0:KD=0:TX$="q":GOSUB210:GOTO4260
8230 IFIN$<>"y"THEN8210
8235 TX$="y":GOSUB210:QQ$=STR$(HN+1)+CHR$(13)+"{f1}REPLY BY:"
8240 QQ$=QQ$+NA$+"{reverse off}{f1} ID#"+STR$(NA):SYS38215:QD$="DATE:"+STR$(MN)+"/"
8250 QD$=QD$+STR$(DA)+"{f1} TIME:"+I$+CHR$(13):FF$="{pound}msg"+STR$(CS)+STR$(CM)
8260 V1=SD(CS):OU$=CHR$(13):GOSUB120:GOSUB2480:IFPEEK(763)=1THEN4260
8270 Z1(CM)=Z1(CM)+1:Z2(CM)=HN+1:GOSUB4150
8280 I=CM:HN=HN+1:A=Z1(CM):B=Z2(CM):GOSUB4180:GOTO4260
