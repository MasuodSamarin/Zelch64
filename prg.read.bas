!--------------------------------------------------
!- Saturday, May 20, 2017 4:57:51 PM
!- Import of : 
!- c:\src\zelch64\prg.read.prg
!- Commodore 64
!--------------------------------------------------
8000 FORI=0TO9:POKE43+I,PEEK(721+I):NEXT:GOTO2605
8010 TX$="{f1}READ MSG #{ct c}":GOSUB5:GOSUB30:CM=I
8050 IFCM>NMORCM<1THENTX$="{f1}END{sh space}OF{sh space}MESSAGES":GOSUB5:CM=NM:WI=0:GOTO2650
8070 I1=Z1(CM):I2=Z2(CM):TX$="{clear}{f1}MESSAGE #"+RIGHT$(STR$(CM),LEN(STR$(CM))-1)
8080 GOSUB5:OPEN3,DV(0,CS),8,"0:{pound}msg "+CHR$(65+CS)+STR$(CM):SYS38212:CLOSE3
8090 IFPEEK(252)=1THENTX$=CR$+"hit return{ct c}":GOSUB5:GOSUB35
8110 TX$="{ct n}{f1}"+STR$(I1)+" REPLY(S) ":GOSUB5:IFI1=0THEN8280
8120 NE=0:I9=0:TX$="{f1}N)EW {f1}S)KIP {f1}Q)UIT {f1}(RETURN)?{ct c}":GOSUB5:C$="nsq"+CR$
8130 GOSUB66:IFG=1THENNE=1:TX$="{f1}SCANNING{sh space}NEW{sh space}REPLYS{f1}.{f1}.{f1}.{ct c}":GOSUB5
8140 ONGGOTO8170,2790,8280,8170
8170 OPEN3,DV(0,CS),8,"0:{pound}msg "+CHR$(65+CS)+STR$(CM):SYS38218
8180 IFI9=0THEN8210
8190 FORI=1TOI9:SYS38218:NEXT
8200 IFI9>=I1THENCLOSE3:GOTO8280
8210 SYS38230:SYS38230:IFVAL(I$)<=PPANDNETHENSYS38218:TX$="{f1}.{ct c}":GOSUB5:GOTO8270
8220 TX$=CR$+"{clear}{f1}RESPONSE #"+STR$(I9+1):GOSUB5:SYS38212
8225 IFPEEK(252)=1THENTX$=CR$+"hit return{ct c}":GOSUB5:GOSUB35
8230 TX$="{ct n}{f1}RETURN OR{sh space}{f1}A)BORT>{ct c}":GOSUB5:C$="a"+CR$:GOSUB66
8240 IFG=1THENCLOSE3:GOTO2650
8270 I9=I9+1:GOTO8200
8280 IFAC<VAL(MID$(A$(0),6,1))ORZ2(CM)=0THEN2650
8290 TX$=CR$+"{ct n}{f1}{reverse off}REPLY (Y/N/Q)?{white}{ct c}":GOSUB5:C$="yqn"+CR$:GOSUB66:IFG>2THEN2650
8300 IFG=2THENWI=0:KD=0:GOTO2650
8340 QQ$=STR$(HN+1)+CR$+"{f1}REPLY BY:"+NA$+"{reverse off}{f1} ID#"+STR$(NA):SYS38215
8350 QD$="{f1}DATE:"+STR$(MN)+"/"+STR$(DA)+"{f1} TIME:"+I$+CR$
8360 FF$="{pound}msg "+CHR$(65+CS)+STR$(CM):V1=DV(0,CS):OU$=CR$:GOSUB21:GOSUB5000
8370 IFS2=1THEN2650
8380 M=CM:HN=HN+1:Z1(M)=Z1(M)+1:Z2(M)=HN:X=Z1(CM):Y=Z2(CM):CC=CC+UC:GOSUB2620
8390 GOTO2650
