!--------------------------------------------------
!- Friday, May 12, 2017 11:10:45 PM
!- Import of : 
!- c:\src\zelch64\bak\emprg.p.prg
!- Commodore 64
!--------------------------------------------------
8000 FORI=0TO9:POKE43+I,PEEK(721+I):NEXT
8010 VD=DV(1,NP):FI$="{pound}empfile.mm":NN=1:GOSUB25
8020 TX$=CR$+"{f1}EMPIRE COMMAND(?):{ct c}":GOSUB5:C$="?cqtygwzo":GOSUB66
8021 IFG<4THENONGGOTO8010,9000,2000
8025 ONG-3GOSUB8100,8200,8300,8400,8500,8600
8026 GOTO8020
8100 TX$="{f1}MAX{sh space}RATE = 50%, NEW RATE:{ct c}":GOSUB5:GOSUB30:IFI<51ANDI>0THENZ1(6)=I
8110 RETURN
8200 TX$="{f1}YOUR{sh space}STATISTICS:":GOSUB5
8205 A$="%":TX$="{clear}{f1}YEAST SOIL:"+STR$(Z1(1))+CR$+"{f1}WARRIORS:"+STR$(Z1(2)):GOSUB5
8210 TX$="{f1}CITIZENS:"+STR$(Z1(3))+CR$+"{f1}WAR SHIPS:"+STR$(Z1(4)):GOSUB5
8220 TX$="{f1}YEAST:"+STR$(Z1(5))+CR$+"{f1}TAX RATE:"+STR$(Z1(6))+A$:GOSUB5
8230 TX$="{f1}CAPITOL CITY:"+STR$(Z1(7))+A$+CR$+"{f1}CITY{sh space}MARKETS:"+STR$(Z1(8)):GOSUB5
8240 TX$="{f1}FOOD PRODUCERS:"+STR$(Z1(9))+CR$+"{f1}SPACE HAULERS:"+STR$(Z1(10))
8260 TX$="{f1}DIPLOMATS:"+STR$(Z1(11))+CR$+"{f1}MONEY:"+STR$(Z1(12)):GOSUB5
8280 TX$="{f1}PLAYS LEFT THIS{sh space}CALL:"+STR$(I1):GOSUB5:RETURN
8300 I=INT(RND(TI)*4)+2:TX$="{f1}ODDS ARE"+STR$(I)+" TO 1":GOSUB5
8310 TX$="{f1}GAMBLE(Y/N)?{ct c}":GOSUB5:C$="yn":IFG=2THENRETURN
8315 Z1(12)=Z1(12)-1000:A=Z1(12)
8320 I=I+1:B=INT(RND(TI)*I)+1:IFB<>1THENTX$="YOU{sh space}LOST!!":GOSUB5:RETURN
8325 A=A+((B-1)*1000):TX$="{f1}YOU{sh space}WON!!!":GOSUB5:Z1(12)=A:GOTO8300
8400 FI$="{pound}empfile.w":NN=1:GOSUB5:RETURN
8500 FI$="{pound}empfile.e":NN=1:GOSUB5:RETURN
8600 TX$="{f1}{clear}SCANNING ZACARIAN{sh space}WARLORDS...":GOSUB5:OPEN2,DV(1,NP),2,"{pound}emprec"
8610 A=U1:B=U2:I=0:U2=0:FORX=1TO20:U1=X:GOSUB4:Z2(I)=VAL(I$)
8620 IFVAL(I$)>0THENINPUT#2,TT$(X)
8630 NEXTX:CLOSE2:OPEN2,8,2,"{pound}log1":U2=0:I=0:FORX=1TO20:IFZ2(X)=0THEN8650
8640 U1=Z2(X):GOSUB4:TX$=STR$(X)+"{f1}NAME:"+I$+CR$+"{f1}LAND{sh space}VALUE:"+TT$(X)
8650 NEXTX:U1=A:U2=B:CLOSE2:RETURN
9000 I1=I1-1:TX$="{clear}{f1}IT'S A{sh space}NEW{sh space}YEAR!":GOSUB5
9010 TX$=CR$+"{f1}YOU{sh space}HAVE"+STR$(Z1(1))+" ACRES OF YEAST SOIL.":GOSUB5:GOSUB9047
9015 ONGGOTO9020,9016,9050,9010
9016 A=20:IFRND(TI)>.8THENA=22
9017 TX$="{f1}SOIL DEALERS PAY $"+STR$(A)+" PER ACRE":GOSUB5:TX$="{f1}SELL{sh space}HOW{sh space}MUCH?{ct c}"
9018 GOSUB5:GOSUB30:IFI>Z1(1)THENTX$="{f1}ILLEGAL AMOUNT!":GOSUB5:GOTO9010
9019 Z1(1)=Z1(1)-I:Z1(12)=Z1(12)+(A*I):TX$="{f1}SOLD!":GOSUB5:GOTO9010
9020 A=25:IFRND(TI)>.8THENA=20
9021 TX$="{f1}SOIL DEALERS WANT $"+STR$(A)+" PER ACRE":GOSUB5:TX$="{f1}BUY{sh space}HOW{sh space}MUCH?{ct c}"
9022 GOSUB5:GOSUB30:IF(I*A)>Z1(12)THENTX$="{f1}NOT ENOUGH MONEY!":GOSUB5:GOTO9010
9023 Z1(1)=Z1(1)+I:Z1(12)=Z1(12)-(A*I):TX$="{f1}BOUGHT!":GOSUB5:GOTO9010
9047 TX$="{f1}B)UY, S)ELL, OR C)ONTINUE (Y):{ct c}":GOSUB5:C$="bscy":GOSUB66
9048 IFG=4THENGOSUB8200
9049 RETURN
9050 TX$=CR$+"{f1}YOU{sh space}HAVE"+STR$(Z1(5))+" POUNDS OF YEAST.":GOSUB5:GOSUB9047
9055 ONGGOTO9060,9056,9100,9050
9056 A=.5:IFRND(TI)>.8THENA=1
9057 TX$="{f1}YEAST DEALERS PAY $"+STR$(A)+" PER LB.":GOSUB5:TX$="{f1}SELL{sh space}HOW{sh space}MUCH?{ct c}"
9058 GOSUB5:GOSUB30:IFI>Z1(5)THENTX$="{f1}ILLEGAL AMOUNT!":GOSUB5:GOTO9050
9059 Z1(5)=Z1(5)-I:Z1(12)=Z1(12)+(A*I):TX$="{f1}SOLD!":GOSUB5:GOTO9050
9060 A=2:IFRND(TI)>.8THENA=1.5
9061 TX$="{f1}YEAST DEALERS WANT $"+STR$(A)+" PER LB.":GOSUB5:TX$="{f1}BUY{sh space}HOW{sh space}MUCH?{ct c}"
9062 GOSUB5:GOSUB30:IF(I*A)>Z1(12)THENTX$="{f1}NOT ENOUGH MONEY!":GOSUB5:GOTO9050
9063 Z1(5)=Z1(5)+I:Z1(12)=Z1(12)-(A*I):TX$="{f1}BOUGHT!":GOSUB5:GOTO9050
9100 A=INT(RND(TI*6))+1:X=INT((Z1(1)*A+(RND(TI)*Z1(3))*A+Z1(5)*A)/3)
9101 IFX>(Z1(1)+Z1(3))*4THENX=(Z1(1)+Z1(3))*4
9110 TX$=CR$+"{f1}THIS YEARS HARVEST IS"+STR$(X)+" POUNDS.":GOSUB5:Z1(5)=Z1(5)+X
9120 TX$="{f1}YOUR PEOPLE REQUIRE"+STR$(Z1(3)*5)+" LBS.":GOSUB5
9130 TX$="{f1}GIVE{sh space}THEM HOW{sh space}MUCH?:{ct c}":GOSUB5:GOSUB30:IFI$="y"THENGOSUB8200:GOTO9120
9140 IFI>Z1(5)THENI=Z1(5):TX$="{f1}YOU{sh space}GIVE THEM{sh space}IT{sh space}ALL!":GOSUB5
9150 I2=I:Z1(5)=Z1(5)-I2:TX$="{f1}YOUR{sh space}ARMY REQUIRES"+STR$(Z1(2)*10)+" LBS.":GOSUB5
9160 TX$="{f1}GIVE{sh space}THEM{sh space}HOW{sh space}MUCH?:{ct c}":GOSUB5:GOSUB30:IFI$="y"THENGOSUB8200:GOTO9160
9170 IFI>Z1(5)THENI=Z1(5):TX$="{f1}YOU{sh space}GIVE THEM{sh space}IT{sh space}ALL!":GOSUB5
9180 I3=I:Z1(5)=Z1(5)-I3:TX$=CR$+"{clear}{f1}REPORT{sh space}THIS{sh space}YEAR!":GOSUB5:I=Z1(3)*5
9190 I4=0:IF(I2/I)<1THENI4=INT((I-I2)/5)-INT(RND(TI)*(I-I2)/5+30):I4=I4*ABS(I4>0)
9192 TX$="{f1}"+STR$(I4)+" CITIZENS STARVED.":GOSUB5:I2=INT(RND(TI)*(Z1(3)/12)+10)
9200 TX$="{f1}"+STR$(I2)+" BABIES BORN.":GOSUB5:I7=INT(RND(TI)*(Z1(3)/10)+20)
9210 TX$="{f1}"+STR$(I7)+" CITIZENS DIED NATURALLY.":GOSUB5
9220 I5=INT(RND(TI)*(Z1(3)/15)+20-Z1(6)+RND(TI)*(Z1(1)/1000)):I6=I2+I5-I4-I7
9230 TX$="{f1}"+STR$(I5)+" PEOPLE IMMIGRATED.":GOSUB5:TX$="{f1}YOUR{sh space}NEW{sh space}POPULATION"
9240 Z1(3)=Z1(3)+I6:Z1(3)=Z1(3)+I6:Z1(3)=Z1(3)*ABS(Z1(3)>0)
9250 TX$=TX$+"IS "+STR$(Z1(3))+".":GOSUB5:IF(Z1(2)*10)<=I3THEN9300
9260 A=INT(RND(TI)*Z1(2)):TX$=STR$(A)+" WARRIORS QUIT!!":GOSUB5:Z1(2)=Z1(2)-A
9300 TX$="{f1}STANDBY...":GOSUB5:
9310 FORI=0TO9:POKE721+I,PEEK(43+I):NEXT:SYS51971:LOAD"{pound}emprg.i",DV(1,NP)
