!--------------------------------------------------
!- Saturday, May 20, 2017 12:04:49 AM
!- Import of : 
!- c:\src\zelch64\d1.prg
!- Commodore 64
!--------------------------------------------------
1 IFPEEK(709)=1THEN2110
2 IFPEEK(709)=2THEN4020
3 IFPEEK(709)=3THEN3110
10 GOTO1000
100 IN$="":SYS49152
110 IFPEEK(830)=1THEN500
120 RETURN
200 IFOU$=""THENRETURN
210 POKE254,ASC(OU$)
220 SYS49155
230 RETURN
300 SYS49158
310 IFPEEK(830)=1THEN500
320 RETURN
400 IFTX$=""THENRETURN
420 SYS49161,TX$
430 RETURN
500 RL=2520:TX$="Standby...":GOSUB400
510 LOAD"{pound}@1",8
600 TX$="Standby...":GOSUB400
610 LOAD"{pound}b1",8
1000 TX$=CHR$(13)+"{white}{pink}U{white}/{yellow}D{white}:":GOSUB400
1010 GOSUB 100:IFIN$=""THEN1010
1015 TX$=IN$:GOSUB400
1020 IFIN$="?"THEN1500
1030 IFIN$="$"THEN1400
1040 IFIN$="q"THEN600
1050 IFIN$="u"THEN2000
1060 IFIN$="d"THEN3000
1070 GOTO 1000
1400 TX$="{clear}UD  Directory...":GOSUB400
1410 OPEN8,MD,0,"$:<*":SYS49176:CLOSE8:GOTO1000
1500 OPEN8,MD,8,"{pound}udmenu,s,r":SYS49164:CLOSE8:GOTO1000
2000 ER=0:POKE512,0:TX$="UPLOAD!":GOSUB400
2010 TX$="Filename:":GOSUB400:GOSUB300
2020 IFLEN(I$)>15ORI$=""THEN1000
2025 IFLEFT$(I$,1)="{pound}"ANDAC<7THEN1000
2030 II=0:FORI=1TOLEN(I$):II$=MID$(I$,I,1):IFII$="*"ORII$="?"ORII$="$"THENII=1
2031 NEXTI:IFII=1THEN1000
2032 FI$=I$:IFLEFT$(I$,1)<>"{pound}"THENFI$="<"+I$
2035 GOSUB2040:GOTO2100
2040 TX$="P)rogram or S)equential:":GOSUB400
2050 GOSUB100:IFIN$=""THEN2050
2060 TX$=IN$:GOSUB400:IFIN$="p"THENFI$=FI$+",p,":TY=1:RETURN
2070 IFIN$="s"THENFI$=FI$+",s,":TY=2:RETURN
2080 GOTO2040
2100 OU$="{clear}":GOSUB200:FI$=FI$+"w":POKE709,1:LOAD"{pound}p.protocol",8,1
2110 IFPEEK(681)=1THENPRINT#5,"GOTO{sh space}SEND!"
2120 IFPEEK(681)=0THENPRINT#5,"goto send!"
2130 SYS49173:SYS49161:IFPEEK(512)=1THEN4000
2140 OPEN1,MD,15:OPEN2,MD,2,FI$:INPUT#1,E1:IFE1>0THENER=1:GOTO4000
2150 FORI=1TO1300:NEXTI:SYS61310:SYS49173:SYS49155
2160 FORX=1TO1000:NEXTX:POKE668,PEEK(667):GOTO4000
3000 POKE512,0:TX$="DOWNLOAD!":GOSUB400
3010 TX$="Filename:":GOSUB400:GOSUB300
3020 IFLEN(I$)>15ORI$=""THEN1000
3025 II$=LEFT$(I$,1):IFII$="{pound}"ANDAC<7THEN1000
3030 IFII$="*"ORII$="?"THEN1000
3031 FI$=I$:IFLEFT$(I$,1)<>"{pound}"THENFI$="<"+I$
3035 GOSUB2040
3050 OU$="{clear}":GOSUB200
3100 FI$=FI$+"r":OPEN1,MD,15:OPEN2,MD,2,FI$:INPUT#1,E1:IFE1>1THEN4000
3105 POKE709,3:LOAD"{pound}p.protocol",MD,1
3110 IFPEEK(681)=1THENPRINT#5,"GOTO{sh space}RECIEVE!"
3120 IFPEEK(681)=0THENPRINT#5,"goto recieve!"
3130 POKE51227,TY:SYS49173:SYS49164
3140 IFPEEK(512)=1THEN4000
3150 SYS49173:POKE51224,255:SYS49158:GOTO4000
4000 CLOSE2:CLOSE1
4010 POKE709,2:LOAD"{pound}v1.5 ml1",MD,1
4020 POKE709,16:POKE512,0:GOTO1000
