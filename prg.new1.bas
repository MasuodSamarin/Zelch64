!--------------------------------------------------
!- Saturday, May 20, 2017 4:57:34 PM
!- Import of : 
!- c:\src\zelch64\prg.new1.prg
!- Commodore 64
!--------------------------------------------------
8000 FORI=0TO9:POKE43+I,PEEK(721+I):NEXT
8010 CLOSE2
8020 TX$="{f1}ENTER YOUR{sh space}HANDLE (UNDER 17 CHARACTERS)"+CR$+":{ct c}":GOSUB5
8030 POKE731,1:GOSUB7:NN$=I$:IFLEN(I$)>17ORI$=""THEN8020
8040 TX$="{f1}ENTER YOUR PHONE NUMBER (XXX/XXX-XXXX)"+CR$+":{ct c}":GOSUB5
8050 GOSUB7:PH$=I$:IFLEN(I$)>16ORI$=""THEN8040
8060 TX$="{f1}ENTER YOUR NAME (UNDER 17 CHARACTERS)"+CR$+":{ct c}":GOSUB5
8070 POKE731,1:GOSUB7:RN$=I$:IFLEN(I$)>17ORI$=""THEN8060
8080 TX$="{f1}ENTER A PASSWORD (UNDER 7 CHARACTERS)"+CR$+":{ct c}":GOSUB5
8090 GOSUB7:PS$=I$:IFLEN(I$)>7ORI$=""THEN8080
8091 TX$="{f1}DOES YOUR{sh space}TERMINAL{sh space}DISPLAY 80"+CR$+"COLUMNS(Y/N)?{ct c}":GOSUB5
8092 C$="yn":GOSUB66
8100 TX$="{clear}{down}{f1}HANDLE:"+NN$+CR$+"{f1}PHONE:"+PH$+CR$+"{f1}NAME:"+RN$:GOSUB5
8105 TX$="{f1}PASSWORD:"+PS$+CR$+"{f1}80 COLUMNS:":IFG=1THENTX$=TX$+"YES":GOTO8110
8107 TX$=TX$+"NO"
8110 GOSUB5:TX$="{f1}{down*3}IS{sh space}THIS{sh space}ALL{sh space}CORRECT?{ct c}":GOSUB5:
8120 GOSUB11:IFIN$="n"THENTX$=IN$:GOSUB5:GOTO8010
8130 IFIN$<>"y"THEN8120
8135 TX$="y":GOSUB5
8140 TX$="{down}{f1}SCANNING USERLOG, STANDBY{ct c}":GOSUB5:U1=1:U2=0:OPEN2,8,3,"0:{pound}log1"
8150 I=0:GOSUB3:GET#2,A$:IFA$<>"{pound}"THEN8200
8160 SYS38233:IFI$="EMPTY"THEN8200
8170 IFI$=NN$THENTX$=CR$+"{f1}ILLEGAL{sh space}HANDLE!":GOSUB5:GOTO8010
8180 TX$="{f1}.{ct c}":GOSUB5:U1=U1+1:IFU1=256THENU2=U2+1:U1=0
8190 GOTO8150
8200 CLOSE2:ID=U1+(256*U2):TX$=" ":GOSUB5:E$="new #"+STR$(ID)+"/"+NN$:GOSUB9
8210 AC$=" 0":CA$=" 0":FORI=0TO9:P(I)=0:NEXTI:P(3)=20:P(6)=6:IFG=1THENP(6)=7
8220 TX$="{clear}{down*7}{f1}YOUR{sh space}ID IS #"+STR$(ID)+CR$+"{f1}YOUR PASSWORD IS "+PS$:GOSUB5
8230 NA=ID:LC$=" 0":TX$="{f1}{down*2}SAVING INFO...":GOSUB5:NA$=NN$:Y0=1:GOSUB58
8240 TX$="{f1}{down*2}COPY THIS INFO AND{sh space}HIT RETURN{ct c}":GOSUB5:GOSUB35:NN=1:FI$="{pound}newuser"
8250 GOSUB25:I$="{pound}prg.new2":GOTO44
